<html><head><title>add marks</title><!--<script type="text/javascript">var hi=0;</script>--></head><body><h1>add marks</h1><?phpif(count($_POST)){	$oldxml = simplexml_load_file('locations.xml');	foreach($oldxml->locations->loc as $place){		$gotmarks = Array();		foreach($_POST as $add=>$what){			if(substr($add,2).''==$place['id'].''){				$gotmarks[] = ltrim(substr($add,0,2),'0');			}			elseif(substr($add,0,4).''=='done' and substr($add,4).''==$place['id'].''){				if(file_exists('donesites.txt')){$old = file_get_contents('donesites.txt');}				else{$old = '';}				if(!strstr($old,$place['id'])){					if($place->name){$old .= $place->name . "\t";}					$old .= $place['id'] . "\n";					file_put_contents('donesites.txt', $old);				}			}		}		if(count($gotmarks)){			$tags_to_place = '';			for($i=0;$i<count($gotmarks);$i++){				$tags_to_place .= $gotmarks[$i].'';				if($i!=count($gotmarks)-1){					$tags_to_place .= ';';				}			}			if($place->t){				$place->t = $tags_to_place;			}			else{				$place->addChild('t', $tags_to_place);			}		}			}	file_put_contents('locations.xml', $oldxml->asXML());	echo 'your tags have been successfully saved.<br />';}?><form action="addmarks.php" method="POST"><!--change action to this page--><input type="submit" value="save" /><table><tbody><?php$xml = simplexml_load_file('locations.xml');if(file_exists('donesites.txt')){$done = file_get_contents('donesites.txt');}else{$done = '';}$tags = $xml->tags->tag;$locs = $xml->locations->loc;$count = 0;$marks = Array('prog','py','php');for($j=0;$j<95;$j++){	echo '<colgroup />';}echo '<colgroup width="500px" />';foreach($locs as $link){	if(strstr($done,$link['id'].'')){continue;}	$output = '';	if($count%10==0){		$colcount = 0;		$output .= '<tr valign="bottom">';		$output .= '<td></td>';		foreach($tags as $m){			if($colcount%20==0){$output .= '<td></td>';}			$colcount++;			$output .= '<td>';			foreach(str_split($m) as $l){				$output .= $l.'<br />';			}			$output .= '</td>';		}		$output .= '</tr>';	}	if($count>50){break;}	$count++;	$output .= '<tr><td><input type="checkbox" name="done' . $link['id'] . '" /></td>';	$colcount = 0;	foreach($tags as $m){		if($colcount%20==0){			$output .= '<td><a href="'.$link->ref.'" target="_blank">';			if(isset($link->name)){$output .= $link->name;}			else{$output .= $link->ref;}			$output .= '</a></td>';		}		$colcount++;		$tagid = $m['id'];		if(strlen($tagid)<2){$tagid = '0'.$tagid;}		$output .= '<td><input type="checkbox" name="'.$tagid.$link['id'].'"';		if(isset($link->t)){			if(in_array($m['id'], explode(';',$link->t))){				$output .= ' checked="checked"';			}		}		$output .=' /></td>';	}	$output .= '<td>';	$output .= '<a href="'.$link->ref.'" target="_blank">';	if(isset($link->name)){$output .= $link->name;}	else{$output .= $link->ref;}	$output .= '</a> ';	if(isset($link->descr)){$output .= '<br /><dd>'.$link->descr.'</dd>';}	$output .= "</td></tr>\n";	echo $output;}?></tbody></table><input type="submit" value="save" /></form></body></html>